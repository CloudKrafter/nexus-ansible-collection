- name: Wait for Nexus API
  ansible.builtin.uri:
    url: "http://localhost:8081/service/rest/v1/status"
    method: GET
    status_code: 200
  register: result
  until: result.status == 200
  retries: 60
  delay: 5

- name: Gather Nexus information
  cloudkrafter.nexus.nexus_info:
    url: http://localhost:8081
    username: admin
    password: changeme
    validate_certs: false
  register: nexus_data

- name: Print Nexus information
  debug:
    msg: "Nexus version is {{ ansible_facts.nexus_info.node_info['nexus-status'].version }}"

- name: Print nexus_data vars
  debug:
    var: nexus_data
    verbosity: 2
